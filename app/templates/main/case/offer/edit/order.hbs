<div class="layout-row layout-align-space-between-center">
  <div class="layout-row layout-align-start-center">
    <h2>
      Selecteer producten voor bestelling AD{{model.requestNumber}} {{visitorPromise.initials}} - {{model.number}}
    </h2>
  </div>
  <div>
    <!-- Buttons on right side of title -->
  </div>
</div>

{{#if (or updateOfferVatRate.isRunning createOrder.isRunning)}}
  <div>
    <PaperProgressLinear />
    <p>Bestelling aanmaken...</p>
  </div>
{{else}}
  {{#if model.offerlines}}
    {{#if hasMixedVatRates}}
      <div class="u-margin-top-small">
        <WarningMessage @message="De geselecteerde lijnen bevatten verschillende BTW tarieven. Hier kan geen bestelling voor opgesteld worden." />
      </div>
    {{/if}}
    <p>Klik op 1 of meer lijnen om toe te voegen aan de bestelling</p>
    <div class="case--order--offerlines-selection">
      {{#each model.offerlines as |offerline|}}
        <div class="case--order--offerlines-selection--offerline layout-row layout-align-start-center
          {{if offerline.isOrdered "case--order--offerlines-selection--offerline--ordered"}}"
          {{action (toggle "isOrdered" offerline)}}>
          <div class="col col--is-ordered">
            {{#liquid-if offerline.isOrdered class="move-up"}}
              {{paper-icon "check" size=28}}
      {{else}}
              {{paper-icon "close" size=28}}
            {{/liquid-if}}
          </div>
          <div class="col col--description">{{{offerline.description}}}</div>
          <div class="col col--amount">{{fmt-currency offerline.amount}}</div>
          <div class="col col--rate">{{offerline.vatRate.rate}}%</div>
        </div>
      {{/each}}
      <div class="case--order--offerlines-selection--total layout-row layout-align-start-center">
        <div class="col col--label">Totaal bestelling</div>
        <div class="col col--amount">{{fmt-currency orderedAmount}}</div>
      </div>
    </div>
  {{else}}
    <div class="u-margin-top-small">
      <WarningMessage @message="Voeg producten toe aan de offerte alvorens u een bestelling kan opstellen." />
    </div>
  {{/if}}
{{/if}}

<div class="layout-row layout-align-end-center">
  <PaperButton @onClick={{action "cancel"}}>Annuleer</PaperButton>
  <PaperButton @primary={{true}} @raised={{true}} @onClick={{perform createOrder}} @disabled={{isDisabledCreate}}>
    Ga verder
  </PaperButton>
</div>

{{#if showIncompatibleVatRatesDialog}}
  <PaperDialog @class="flex-50" @onClose={{action "closeIncompatibleVatRatesDialog"}} @clickOutsideToClose={{true}} @parent=".main-outlet" @origin=".main-outlet">
    <PaperToolbar>
      <PaperToolbarTools>
        <h2>Opgelet</h2><span class="flex"></span>
        <PaperButton @iconButton={{true}} @onClick={{action "closeIncompatibleVatRatesDialog"}}>
          <PaperIcon @icon="close" />
        </PaperButton>
      </PaperToolbarTools>
    </PaperToolbar>

    <PaperDialogContent>
      <p>
        Het BTW-tarief van de offerte is {{model.vatRate.rate}}% terwijl de geselecteerde lijnen BTW-tarief {{orderedVatRate.rate}}% hebben.
      </p>
      <p>
        Mag het BTW-tarief van de offerte aangepast worden naar {{orderedVatRate.rate}}%?
      </p>
    </PaperDialogContent>

    <PaperDialogActions @class="layout-row">
      <span class="flex"></span>
      <PaperButton @onClick={{action "closeIncompatibleVatRatesDialog"}}>Terug</PaperButton>
      <PaperButton @onClick={{perform updateOfferVatRate}}>Pas BTW-tarief aan</PaperButton>
    </PaperDialogActions>
  </PaperDialog>
{{/if}}