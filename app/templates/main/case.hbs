<CaseTabs @model={{case}} />

{{liquid-outlet}}

{{#if model}}
  <h2>
    Klant: <PrintName @model={{model}} /> <span class="small-text-fade">[{{model.number}}]</span>
    {{#paper-link 'main.customers.edit' model iconButton=true}}
      {{paper-icon "open in new"}}
      <PaperTooltip>Open klant</PaperTooltip>
    {{/paper-link}}
  </h2>

  <div class="resource-details">
    <div class="layout-row layout-xs-column">
      <div class="left-column">
        <DetailIconListItem @icon={{if model.isCompany "business" "person"}} @label={{if model.isCompany "Bedrijf" "Naam"}} @class="resource-details--section-name">
          <div>
            {{#if model.printInFront}}{{model.honorificPrefix.name}}{{/if}}
            {{model.prefix}} {{model.name}} {{model.suffix}}
            {{#if (not model.printInFront)}}{{model.honorificPrefix.name}}{{/if}}
          </div>
          <div>{{format-vat-number model.vatNumber}}</div>
        </DetailIconListItem>

        <DetailIconListItem @icon="location on" @label="Adres" @class="resource-details--section-address">
          <div>{{model.address1}}</div>
          <div>{{model.address2}}</div>
          <div>{{model.address3}}</div>
          <div>{{model.postalCode}} {{model.city}}</div>
          <div>{{model.country.name}}</div>
        </DetailIconListItem>

        <DetailIconListItem @icon="language" @label="Taal" @class="resource-details--section-language">
          {{model.language.name}}
        </DetailIconListItem>

        <DetailIconListItem @icon="phone" @label="Telefoon" @class="resource-details--section-telephone">
          {{#each model.telephones as |tel|}}
            <div>
              {{tel.telephoneType.name}}:
              {{format-phone tel.country.telephonePrefix tel.area tel.number}}
              {{#if tel.memo}}({{tel.memo}}){{/if}}
            </div>
          {{/each}}
        </DetailIconListItem>

        <DetailIconListItem @icon="mail outline" @label="E-mail" @class="resource-details--section-contact">
          <div><FmtEmail @value={{model.email}} /></div>
          <div><FmtEmail @value={{model.email2}} /></div>
          <div>{{model.url}}</div>
        </DetailIconListItem>

        <DetailIconListItem @icon="assignment" @label="Memo" @class="resource-details--section-memo">
          <div {{action (toggle "memoExpanded" this)}}>
            {{#if model.memo}}
              {{#if memoExpanded}}
                Memo {{paper-icon "expand less"}}
              {{else}}
                Memo {{paper-icon "expand more"}}
              {{/if}}
              {{#liquid-if memoExpanded class="expand-more"}}
                <span class="html-body">{{model.memo}}</span>
              {{/liquid-if}}
            {{else}}
              Geen memo
            {{/if}}
          </div>
        </DetailIconListItem>
      </div>
      <div class="right-column layout-column">
        <div>
          <div class="layout-row layout-align-space-between-center">
            <h3>Gebouw</h3>
            {{#if isEnabledEditBuilding}}
              <PaperButton @onClick={{action "toggleBuildingEdit"}} @iconButton={{true}}>
                {{paper-icon "exit to app"}}
                <PaperTooltip>Sluiten</PaperTooltip>
              </PaperButton>
            {{else if isUpdatingBuilding}}
              <PaperProgressCircular @diameter={{18}} />
            {{else}}
              <PaperButton @onClick={{action "toggleBuildingEdit"}} @iconButton={{true}}>
                {{paper-icon "edit mode"}}
                <PaperTooltip>Aanpassen</PaperTooltip>
              </PaperButton>
            {{/if}}
          </div>
          {{#unless isEnabledEditBuilding}}
            {{#if building}}
              <BuildingDetailCard @model={{building}} />
            {{else}}
              <p>n.v.t.</p>
            {{/if}}
          {{else}}
            <InputField::BuildingSelect @value={{building}} @customer={{model}} @onSelectionChange={{action "updateBuilding"}} @class="md-input-wrapper xxxxlarge" />
          {{/unless}}
        </div>
        <div>
          <div class="layout-row layout-align-space-between-center">
            <h3>Contact</h3>
            {{#if isEnabledEditContact}}
              <PaperButton @onClick={{action "toggleContactEdit"}} @iconButton={{true}}>
                {{paper-icon "exit to app"}}
                <PaperTooltip>Sluiten</PaperTooltip>
              </PaperButton>
            {{else if isUpdatingContact}}
              <PaperProgressCircular @diameter={{18}} />
            {{else}}
              <PaperButton @onClick={{action "toggleContactEdit"}} @iconButton={{true}}>
                {{paper-icon "edit mode"}}
                <PaperTooltip>Aanpassen</PaperTooltip>
              </PaperButton>
            {{/if}}
          </div>
          {{#unless isEnabledEditContact}}
            {{#if contact}}
              <ContactDetailCard @model={{contact}} />
            {{else}}
              <p>n.v.t.</p>
            {{/if}}
          {{else}}
            <InputField::ContactSelect @value={{contact}} @customer={{model}} @onSelectionChange={{action "updateContact"}} @class="md-input-wrapper xxxxlarge" />
          {{/unless}}
        </div>
      </div>
    </div>
    <div class="resource-details--section resource-details--section-audit layout-row">
      Aangemaakt: {{moment-format model.created}}
    </div>
  </div>
{{else}}
  <PaperButton @onClick={{null}}>Koppel klant</PaperButton>
{{/if}}